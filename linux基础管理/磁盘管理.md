首先要将多个物理磁盘创建为各自独立的pv
再将多个pv合成vg存储池
这个池子就可以自由分配创建lv了
lvm可以动态扩容


扩容需要使用到
vgextend 把池子扩充需要加入pv
lvextend把逻辑卷扩容需要加入vg
注意扩容后需要使用xfs_growfs让lv识别

```
1.请说明LVM和RAID的关系
RAID是磁盘阵列，在硬件层面上给多块磁盘分组实现不同功能，可提供数据备份、硬盘加速功能。
LVM是逻辑卷管理，在软件层面上给多块磁盘分组实现不同功能，可动态管理扩容，无需关机重启，更加灵活。

2.为什么需要使用LVM，LVM解决什么问题
在部署服务器时不确定磁盘需求容量，后续如果需要进行磁盘扩容，需要停止服务器业务，迁移旧磁盘数据。
如果使用LVM则可以实现动态扩容，在不停止服务器业务的情况下扩充磁盘空间。

3.解释以下LVM的名词
PV	物理卷，分配给LVM使用的磁盘或磁盘分区
VG	卷组，由一个或多个物理卷组成的存储池
LV	逻辑卷，可以在卷组基础上创建多个逻辑卷

4.请简述LVM的创建流程
1、添加磁盘
2、创建物理卷(PV)
3、创建卷组(VG)，将多个物理卷组合成一个卷组
4、在卷组基础上创建多个逻辑卷(LV)
5、格式化各逻辑卷
6、将各逻辑卷挂载到指定目录
7、检查挂载情况并测试
8、写入开机自启动挂载

5.请简述LVM的扩容流程
1、添加磁盘
2、创建新的物理卷(PV)
3、对卷组(VG)进行扩容
4、给指定的逻辑卷(LV)扩容
5、让系统识别扩容后的空间(xfs_growfs)
6、检查容量并测试

```
需求：

```
1.将虚拟机还原快照
2.添加6块10G的新磁盘
3.将sdb,sdc组合成vg01
pvcreate /dev/sdb /dev/sdc
vgcreate -s 16M vg01 /dev/sdb /dev/sdc

4.使用vg01创建两个lv,分别为lv01使用70% lv02使用剩下所有的容量
lvcreate -l 70%VG -n lv01 vg01
lvcreate -l 100%FREE -n lv02 vg01

5.将lv01挂载到/data1
mkdir -p /data1
mkfs.xfs /dev/mapper/vg01-lv01
mount /dev/mapper/vg01-lv01 /data1

6.将lv02挂载到/data2
mkdir -p /data2
mkfs.xfs /dev/mapper/vg01-lv02
mount /dev/mapper/vg01-lv02 /data2

7.使用dd命令分别往/data1和/data2写入1G大小的测试文件
dd if=/dev/zero of=/data1/1G.txt bs=1M count=1024
dd if=/dev/zero of=/data2/1G.txt bs=2M count=512

8.将sdd扩容到vg01
pvcreate /dev/sdd
vgextend vg01 /dev/sdd

9.扩容lv01使用vg01所有未分配的容量
lvextend -l +100%FREE /dev/mapper/vg01-lv01

10.使/data1能动态识别到扩容后的容量
xfs_growfs /dev/mapper/vg01-lv01

11.使用dd命令分往/data1写入10G大小的测试文件
dd if=/dev/zero of=/data1/10G.txt bs=10M count=1024

12.将sde和sdf组合成vg02
pvcreate /dev/sde /dev/sdf
vgcreate -s 16M vg02 /dev/sde /dev/sdf

13.使用vg02创建1个lv,名称为lv03,使用vg02所有的容量
lvcreate -l 100%VG -n lv03 vg02

14.将lv03挂载到/data3目录
mkdir -p /data3
mkfs.xfs /dev/mapper/vg02-lv03
mount /dev/mapper/vg02-lv03 /data3

15.将sdg扩容到vg02
pvcreate /dev/sdg
vgextend vg02 /dev/sdg

17.使用vg02创建1个lv,名称为lv04,大小为4G
lvcreate -L 4G -n lv04 vg02

16.将lv03扩容使用vg02所有剩余的容量
lvextend -l +100%FREE /dev/mapper/vg02-lv03

17.使系统能正常识别lv03扩容后的正确容量
xfs_growfs /dev/mapper/vg02-lv03

18.将lv04挂载到/data4
mkdir -p /data4
mkfs.xfs /dev/mapper/vg02-lv04
mount /dev/mapper/vg02-lv04 /data4

19.设置开机自动挂载/data1 /data2 /data3 /data4
先备份 
cp /etc/fstab /opt/

再编辑 
vim /etc/fstab
/dev/mapper/vg01-lv01 /data1 xfs defaults 0 0
/dev/mapper/vg01-lv02 /data2 xfs defaults 0 0
/dev/mapper/vg02-lv03 /data3 xfs defaults 0 0
/dev/mapper/vg02-lv04 /data4 xfs defaults 0 0

然后 mount -a

20.重启并检查是否可以自动挂载
reboot 
df -h | grep "/dev/mapper/vg"

21.将刚才创建的文件删除，虚拟机还原最初的状态
```