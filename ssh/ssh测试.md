---
tags:
  - ssh
---
>windows:

- xshell生成密钥对

- 将xshell公钥上传到管理机m-61

>m-61 管理机-可手动操作:

- 更改ssh默认端口号为9999

- 关闭用户名密码登录方式

>被管理机-可手动操作:

- 更改ssh默认端口号为9999

- 关闭用户名密码登录方式

- 指定监听内网地址 172.16.1.x



>实现效果:

- 管理机m-61只能通过xshell的秘钥方式连接,IP地址用户名密码方式不允许

- 所有主机ssh端口修改为9999

- 被管理机只能通过管理机通过172内网地址使用秘钥认证连接,10网段不允许连接.不允许使用账号密码方连接



>一个脚本完成以下所有任务：

- 管理机自动创建密钥对

- 管理机自动将公钥免交互发送到被管理机

- 远程修改被管理机的SSH连接端口为9999

- 远程修改被管理机的SSH监听地址为172.16.1.X

- 远程修改被管理机不允许使用账号密码方式登陆，只允许使用密钥方式连接

- 远程修改完 之后验证是否生效，验证方法为使用9999端口连接被管理机并打印出主机信息



>完成提高作业的基础之上：

- 在m-61上完成远程一键安装rsyncd服务端并好配置文件并启动

- 在m-61上完成远程一键安装nfs服务端及修改好配置文件并启动

- 在m-61上完成远程一键安装lsyncd服务以及修改好配置文件并启动

- 在m-61上完成web服务器正常挂载并写入挂载自启动配置文件

- 所有服务安装完成后测试成功

- web服务器可以正常挂载nfs共享目录

- web服务器上传文件后，nfs服务器自动把?文件实时同步到backup服务器
