# 建立索引的原则

## 1.说明

为了使索引的使用效率更高，在创建索引时，必须考虑在哪些字段上创建索引和创建什么类型的索引。

## 2.降低索引树高度

(必须的)建表时一定要有主键,一般是个无关业务的自增列数字列。

## 3.选择唯一性索引

```
1.唯一性索引的值是唯一的，可以更快速的通过该索引来确定某条记录。
2.例如，学生表中学号是具有唯一性的字段。为该字段建立唯一性索引可以很快的确定某个学生的信息。
3.如果使用姓名的话，可能存在同名现象，从而降低查询速度。
```

优化方案:

```
1.如果非得使用重复值较多的列作为查询条件(例如:男女),可以将表逻辑拆分
2.可以将此列和其他的查询类,做联和索引
select count(*) from world.city;
select count(distinct countrycode) from world.city;
select count(distinct countrycode,population ) from world.city;
```

## 4.尽量使用前缀来索引

如果索引字段的值很长，最好使用值的前缀来索引。

## 5.限制索引的数目

```
索引的数目不是越多越好。
可能会产生的问题:
1.每个索引都需要占用磁盘空间，索引越多，需要的磁盘空间就越大。
2.修改表时，对索引的重构和更新很麻烦。越多的索引，会使更新表变得很浪费时间。
3.优化器的负担会很重,有可能会影响到优化器的选择.
4.percona-toolkit中有个工具,专门分析索引是否有用
```

## 6.删除不再使用或很少使用的索引(percona toolkit)

```
1.表中的数据被大量更新，或者数据的使用方式被改变后，原有的一些索引可能不再需要。
2.数据库管理员应当定期找出这些索引，将它们删除，从而减少索引对更新操作的影响。
```

## 7.建索引原则总结

```
1.必须要有主键,如果没有可以做为主键条件的列,创建无关列
2.经常做为where条件列  order by  group by  join on, distinct 的条件(业务:产品功能+用户行为)
3.最好使用唯一值多的列作为索引,如果索引列重复值较多,可以考虑使用联合索引
4.列值长度较长的索引列,我们建议使用前缀索引.
5.降低索引条目,一方面不要创建没用索引,不常使用的索引清理,percona toolkit(xxxxx)
6.索引维护要避开业务繁忙期，建议用pt-osc
```
